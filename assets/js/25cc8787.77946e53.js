"use strict";(self.webpackChunkearthnut_doc_of_docusaurus=self.webpackChunkearthnut_doc_of_docusaurus||[]).push([[8914],{3495:(e,n,c)=>{c.r(n),c.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>p,frontMatter:()=>t,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"qqi/check-version","title":"qqi\uff1a\u68c0\u6d4b\u5305\u7248\u672c (@qqi/check-version) - npm","description":"\u7528\u4e8e\u68c0\u6d4b npm \u5e93\u5305\u7684\u7248\u672c\u662f\u5426\u5df2\u5b58\u5728\uff0c\u4e14\u8fd4\u56de\u8bc6\u522b\u7684 dist-tag (\u9700\u8981\u662f\u7b26\u5408\u6807\u51c6\u7684\u7248\u672c\u53f7\uff0c\u5426\u5219\u5c06\u8bc6\u522b\u4e3a latest)","source":"@site/npm/qqi/check-version.mdx","sourceDirName":"qqi","slug":"/qqi/check-version","permalink":"/npm/qqi/check-version","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"qqi\uff1a\u68c0\u6d4b\u5305\u7248\u672c (@qqi/check-version) - npm","sidebar_label":"\u68c0\u6d4b\u5305\u7248\u672c\uff08@qqi/check-version\uff09","hide_title":true},"sidebar":"BpyHRv4hwAZXs48D","previous":{"title":"\u65e5\u5fd7\uff08log\uff09","permalink":"/npm/qqi/log"},"next":{"title":"\u79fb\u9664 dev \u521b\u5efa\u7684 dog","permalink":"/npm/qqi/remove-dog"}}');var i=c(7259),r=c(9087);const t={title:"qqi\uff1a\u68c0\u6d4b\u5305\u7248\u672c (@qqi/check-version) - npm",sidebar_label:"\u68c0\u6d4b\u5305\u7248\u672c\uff08@qqi/check-version\uff09",hide_title:!0},o="\u68c0\u6d4b\u5f53\u524d npm \u5305\u7684\u7248\u672c",a={},l=[{value:"\u5b89\u88c5",id:"\u5b89\u88c5",level:2},{value:"\u4f7f\u7528",id:"\u4f7f\u7528",level:2},{value:"\u4f7f\u7528\u793a\u4f8b",id:"\u4f7f\u7528\u793a\u4f8b",level:2}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,r.R)(),...e.components},{InstallInfo:c,PackageInfo:s}=n;return c||d("InstallInfo",!0),s||d("PackageInfo",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"\u68c0\u6d4b\u5f53\u524d-npm-\u5305\u7684\u7248\u672c",children:"\u68c0\u6d4b\u5f53\u524d npm \u5305\u7684\u7248\u672c"})}),"\n",(0,i.jsx)(s,{packageName:"@qqi/check-version",githubRepoName:"qqi"}),"\n",(0,i.jsxs)(n.p,{children:["\u7528\u4e8e\u68c0\u6d4b npm \u5e93\u5305\u7684\u7248\u672c\u662f\u5426\u5df2\u5b58\u5728\uff0c\u4e14\u8fd4\u56de\u8bc6\u522b\u7684 ",(0,i.jsx)(n.code,{children:"dist-tag"})," (\u9700\u8981\u662f\u7b26\u5408\u6807\u51c6\u7684\u7248\u672c\u53f7\uff0c\u5426\u5219\u5c06\u8bc6\u522b\u4e3a ",(0,i.jsx)(n.code,{children:"latest"}),")"]}),"\n",(0,i.jsx)(n.h2,{id:"\u5b89\u88c5",children:"\u5b89\u88c5"}),"\n",(0,i.jsx)(c,{name:"@qqi/check-version",dev:!0}),"\n",(0,i.jsx)(n.h2,{id:"\u4f7f\u7528",children:"\u4f7f\u7528"}),"\n",(0,i.jsxs)(n.p,{children:["\u9ed8\u8ba4\u4f7f\u7528\u65b9\u5f0f\u4e3a\u4f20\u5165 ",(0,i.jsx)(n.code,{children:"name"})," \u53c2\u6570\uff0c\u4ee3\u7801\u5c06\u6267\u884c\u5224\u65ad\u5de5\u4f5c\u76ee\u5f55\u4e0b\u7684 'packages/[name]' \u5b50 npm \u5305\u7684\u7248\u672c\u53f7\u662f\u5426\u5df2\u5b58\u5728\u4e8e\u7ebf\u4e0a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# \u5199\u6cd5\u4e00\nnpx @qqi/check-version name=[name]\n# \u5199\u6cd5\u4e8c\nnpx @qqi/check-version n=[name]\n# \u5199\u6cd5\u4e09\nnpx @qqi/check-version name [name]\n# \u5199\u6cd5\u56db\nnpx @qqi/check-version n [name]\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u4e5f\u53ef\u4ee5\u4f20\u5165 ",(0,i.jsx)(n.code,{children:"cwd"})," \u53c2\u6570\u8986\u76d6\u9ed8\u8ba4\u7684\u5224\u65ad\u6587\u4ef6\u5939\uff0c\u9ed8\u8ba4\u67e5\u627e 'packages' \u6587\u4ef6\u5939\u4e0b\u5b50 npm \u5305\uff0c\u82e5\u60a8\u4e60\u60ef\u4e8e\u5176\u4ed6\u547d\u540d\u65b9\u5f0f"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# \u5018\u82e5\u5b50\u4e3b\u5305 core \u5728 lists \u6587\u4ef6\u5939\u4e0b\nnpx @qqi/check-version name=core cwd=lists  # \u63a8\u8350\u6a21\u5f0f\n\nnpx @qqi/check-version name core cwd lists\n\nnpx @qqi/check-version name=core cwd lists\n\nnpx @qqi/check-version name core cwd=lists\n\nnpx @qqi/check-version n=core c=lists  # \u63a8\u8350\u6a21\u5f0f\n\nnpx @qqi/check-version n core c lists\n"})}),"\n",(0,i.jsx)(n.p,{children:'\u9ed8\u8ba4\u7684 name \u503c\u4e3a "." \uff0c\u5373\u4ee5 packages \u76ee\u5f55\u4e3a\u9879\u76ee\u7684\u6839\uff08\u5018\u82e5 package.json \u6587\u4ef6\u5728\u8fd9\u91cc\u7684\u8bdd\uff09'}),"\n",(0,i.jsx)(n.p,{children:"\u4f7f\u7528 skip \u53c2\u6570\u662f\u5426\u8df3\u8fc7\u6267\u884c\u7ebf\u4e0a\u7248\u672c\u68c0\u6d4b\uff08\u56e0\u4e3a '0.0.0' \u7684\u7248\u672c\u9ed8\u8ba4\u4e3a\u8df3\u8fc7\u68c0\u6d4b\uff0c\u82e5\u521d\u59cb\u7248\u672c\u975e '0.0.0' \u65f6 \uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u8be5\u53c2\u6570\u8df3\u8fc7\u68c0\u6d4b\uff09"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# \u5018\u82e5\u5b50\u4e3b\u5305 core \u5728 lists \u6587\u4ef6\u5939\u4e0b\nnpx @qqi/check-version name=core cwd=lists skip  # \u63a8\u8350\u6a21\u5f0f\n\nnpx @qqi/check-version name=core cwd lists skip\n\nnpx @qqi/check-version n=core c=lists s # \u63a8\u8350\u6a21\u5f0f\n\nnpx @qqi/check-version n=core c lists s\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u82e5\u60f3\u5728\u5176\u4ed6\u975e\u5206\u5305\u7684\u9879\u76ee\u4f7f\u7528\uff0c\u5373\u5355\u72ec\u7684\u9879\u76ee\u4f7f\u7528\u914d\u7f6e\uff0c\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"npx @qqi/check-version c=."})," \u5373\u53ef\u3002"]}),"\n",(0,i.jsx)(n.h2,{id:"\u4f7f\u7528\u793a\u4f8b",children:"\u4f7f\u7528\u793a\u4f8b"}),"\n",(0,i.jsxs)(n.p,{children:["\u5728 ",(0,i.jsx)(n.code,{children:"pub.sh"})," \u6587\u4ef6\u4e2d\u4f7f\u7528\u65f6\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'CHECK_VERSION="@qqi/check-version"\ninstall_check_version() {\n    if ! npm  list -g --depth=0 | grep -q " ${CHECK_VERSION}"; then\n        echo "\u5f53\u524d\u672a\u5168\u5c40\u5b89\u88c5 \'${CHECK_VERSION}\'\uff0c\u5373\u5c06\u8fdb\u884c\u5b89\u88c5"\n        npm install ${CHECK_VERSION} --global\n    else\n         echo "\u5305 ${CHECK_VERSION} \u5df2\u5168\u5c40\u5b89\u88c5"\n    fi\n}\n# \u8f93\u51fa\u7684 npm \u53d1\u5e03\u7684 tag\u3002\u4e5f\u53ef\u4ee5\u901a\u8fc7\u8c03\u6574 cwd \u548c name \u7684\u53c2\u6570\u6765\u9002\u914d\u5b9e\u9645\u7684\u9879\u76ee\u5730\u5740\ntag=""\ninstall_check_version\nif ! tag=$(npx "${CHECK_VERSION}" c=. 2>&1); then\n    echo "\u672a\u901a\u8fc7\u7248\u672c\u6821\u9a8c\uff1a$tag"\n    exit 1\nfi\necho "\u83b7\u53d6\ud83c\ude50\u53d1\u5e03\u6807\u7b7e\u4e3a ${tag}"\n# \u5b89\u88c5\nnpm ci\n\necho "\u5f00\u59cb\u53d1\u5e03 npm \u5305"\n\nif ! npm publish --provenance --access public --tag ${tag} ; then\n    echo "\u53d1\u5e03\u5931\u8d25"\n    exit 0\nfi\n\necho "\ud83d\ude80\ud83d\ude80  \u53d1\u5e03\u6210\u529f\uff0c\u5b8c\u7ed3 \ud83c\udf89\ud83c\udf89 \u6492\u82b1 \ud83c\udf89\ud83c\udf89"\n'})}),"\n",(0,i.jsxs)(n.p,{children:["\u4f7f\u7528 ",(0,i.jsx)(n.a,{href:"https://www.npmjs.com/package/@qqi/check-version",children:(0,i.jsx)(n.code,{children:"npx @qqi/check-version"})})," \u83b7\u53d6\u7684 tag \u662f\u7b26\u5408\u6807\u51c6 npm \u7684\u9884\u53d1\u5e03\u7248\u672c\u7684\u7248\u672c\u53f7\u7684\u89c4\u5219\u3002\u901a\u8fc7 ",(0,i.jsx)(n.a,{href:"https://www.npmjs.com/package/vjj",children:(0,i.jsx)(n.code,{children:"npx vjj"})})," \u8fdb\u884c\u7248\u672c\u7684\u8fed\u4ee3\u7ba1\u7406\u5373\u7b26\u5408\u6807\u51c6\u7684 npm \u7684 publish \u7684\u9884\u53d1\u5e03\u7684 tag \uff0c\u4e5f\u5c06\u5728 ",(0,i.jsx)(n.code,{children:"CHANGELOG.md"})," \u6587\u4ef6\u6dfb\u52a0\u66f4\u65b0\u8fed\u4ee3\u7684\u7248\u672c\u7684\u65e5\u5fd7\u8bb0\u5f55\u7684\u6807\u9898\uff08\u5e7f\u5b50\uff0c\u8fd9\u5c31\u662f\u5e7f\u5b50\uff09\u3002"]}),"\n",(0,i.jsx)(n.p,{children:'\u6240\u4ee5\uff0c\u4e0a\u9762\u7684 .sh \u6587\u4ef6\u5c06\u63d0\u53d6 "0.0.1" \u7684 tag \u503c\u4e3a "latest"\uff0c\u82e5\u63d0\u53d6 "0.1.0-test.0" \u5219\u63d0\u53d6\u51fa "test"'})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}function d(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},9087:(e,n,c)=>{c.d(n,{R:()=>t,x:()=>o});var s=c(6363);const i={},r=s.createContext(i);function t(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);